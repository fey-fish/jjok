[manifest]
version = "0.1.0"
dump_lua = true
priority = 0

#multi joker slot system
[[patches]]
[patches.pattern]
target = 'card.lua'
pattern = '''
self.unique_val = 1-self.ID/1603301
self.edition = nil
'''
position = "after"
payload = '''
self.slots = center.slots or 1
'''
match_indent = true

[[patches]]
[patches.pattern]
target = 'card.lua'
pattern = '''
return generate_card_ui(self.config.center, nil, loc_vars, card_type, badges, hide_desc, main_start, main_end, self)
'''
position = "at"
payload = '''
local full_UI_table = generate_card_ui(self.config.center, nil, loc_vars, card_type, badges, hide_desc, main_start, main_end, self)
if self and self.slots ~= 1 then
  full_UI_table.multi_box = full_UI_table.multi_box or {}
  local mb = #full_UI_table.multi_box
  full_UI_table.main.main_box_flag = true
  local k = G.localization.descriptions['Other']['jjok_slots']
  for i, box in ipairs(k.text_parsed) do
    for j, line in ipairs(box) do
      local o = SMODS.localize_box(line, {scale = 1, vars = {tostring(self.slots)}})
      full_UI_table.multi_box[mb + 1] = full_UI_table.multi_box[mb + 1] or {}
      full_UI_table.multi_box[mb + 1][#full_UI_table.multi_box[mb + 1] + 1] = o
    end
  end
end
return full_UI_table
'''
match_indent = true